## 分布式锁

### 数据库实现



### redis实现

### 单点锁

1，可能会出现主挂了，此时从还没有同步数据，此时从升级为主，那么从也可以加锁成功

2，单点锁可能会出现的问题

如果jvm出现了stw，正好锁过期被释放了，那么也是会出现问题

### 红锁（奇数台）

1，准备多台redis，但是不是主从复制的。是独立的

2，过半加锁成功



### zk实现

zk可能也会失败，

1，当加锁成功之后，jvm出现了stw，那么也会释放

2，这时就需要在数据库中插入一行记录



## 分布式事务

### 1，消息队列 & 本地事务表·

